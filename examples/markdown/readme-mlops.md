<!--README-AI.md file generated by @eli64s/readme-ai-->

<div align="left">
<h1><img src=https://img.icons8.com/nolan/96/markdown.png width="100" />
<br>MLOPS-COURSE</h1>
<h3>◦ Unlock the potential of your code repository.</h3>
<h3>◦ Developed with the software and tools below.</h3>
</div>
<p align="left">
<a href="https://skillicons.dev">
<img src="https://skillicons.dev/icons?i=fastapi,py,md,github,git&theme=light">
</a>
</p>
<hr>

##  Quick Links
- [🔗 Quick Links](#-quick-links)
- [📍 Overview](#-overview)
- [📦 Features](#-features)
- [📂 Repository Structure](#-repository-structure)
- [🧩 Modules](#modules)
- [🚀 Getting Started](#-getting-started)
    - [⚙️ Installation](#-installation)
    - [🤖 Running mlops-course](#-running-mlops-course)
    - [🧪 Tests](#-tests)
- [🚧 Roadmap](#-roadmap)
- [🤝 Contributing](#-contributing)
- [📄 License](#-license)
- [👏 Acknowledgments](#-acknowledgments)

---

##  Overview

The code repository is a comprehensive collection of scripts and files that support machine learning operations (MLOps) workflows. It includes functionalities for training, tuning, evaluating, and serving machine learning models. The codebase provides tools and utilities for data preprocessing, model architecture, prediction, and performance evaluation. Additionally, it offers deployment configurations for scaling and serving models on clusters using various technologies like AWS and AnyScale. The repository utilizes popular Python libraries such as PyTorch, Transformers, scikit-learn, and matplotlib, alongside MLOps tools like MLflow and Ray Tune. The extensive structure and dependencies ensure streamlined development and deployment of machine learning models.

---

##  Features

|    | Feature            | Description                                                                                                        |
|----|--------------------|--------------------------------------------------------------------------------------------------------------------|
| ⚙️ | **Architecture**   | The repository follows a modular and organized structure with separate directories for different functionalities. The codebase is designed with a focus on machine learning operations (MLOps). It includes directories for deployment, model serving, training, tuning, evaluation, data processing, and utilities. The architecture allows for easy maintenance and scalability.             |
| 📄 | **Documentation**  | The repository includes comprehensive and well-structured documentation. It provides clear instructions on how to set up and use the different functionalities of the codebase. The documentation covers topics such as dependencies, deployment configurations, workflows, and usage examples. The documentation helps new users understand and make the best use of the codebase. |
| 🔗 | **Dependencies**   | The codebase has external dependencies defined in the `requirements.txt` file. These dependencies include libraries for machine learning (e.g., PyTorch, Transformers, scikit-learn), deployment (e.g., FastAPI, Ray), data processing (e.g., pandas, numpy), and documentation (e.g., MkDocs). The dependencies are well-managed, ensuring the required libraries are installed for the codebase to function properly. |
| 🧩 | **Modularity**     | The system demonstrates good modularity with a clear separation of concerns. Each directory in the codebase focuses on a specific functionality or component. For example, the `deploy` directory contains configurations for deployment, the `madewithml` directory includes code for machine learning operations, and the `notebooks` directory contains Jupyter notebooks for various tasks. This modularity enhances maintainability and reusability of the codebase. |
| 🧪 | **Testing**        | The codebase includes a Makefile and configuration files for running various testing tools, such as Pytest, Flake8, and Black. These tools ensure code quality, style compliance, and test coverage. The repository also includes workflows utilizing GitHub Actions for automated testing and continuous integration. The testing setup helps in identifying and resolving issues early in the development process. |
| ⚡️  | **Performance**    | The codebase leverages efficient libraries like PyTorch and Transformers for machine learning tasks, ensuring high-performance models. Additionally, the use of Ray for distributed computing enables scalability and efficient resource utilization. The codebase aims to optimize performance by utilizing appropriate algorithms, data preprocessing techniques, and parallel computing capabilities. |
| 🔐 | **Security**       | The repository takes security measures by utilizing secure coding practices and integrating deployment configurations with authentication mechanisms. The configurations for serving and deployment include components like authentication tokens, runtime environment variables, and SSL certificates, ensuring secure communication and access to sensitive resources. |
| 🔀 | **Version Control**| The repository follows a version control workflow using Git. It includes a `.git` directory and utilizes features such as branches, commits, and pull requests to manage code changes and collaboration. The use of GitHub Actions further streamlines the version control process, automating workflows and ensuring code integrity. |
| 🔌 | **Integrations**   | The codebase integrates with various systems and services. It includes integrations with machine learning frameworks (PyTorch, Transformers), deployment frameworks (FastAPI, AWS), and testing tools (Pytest, Flake8). The repository also includes convenient workflows for

---

##  Repository Structure

```sh
└── mlops-course/
    ├── .github/
    │   └── workflows/
    │       ├── documentation.yaml
    │       ├── json_to_md.py
    │       ├── serve.yaml
    │       └── workloads.yaml
    ├── Makefile
    ├── datasets/
    ├── deploy/
    │   ├── cluster_compute.yaml
    │   ├── cluster_env.yaml
    │   ├── jobs/
    │   │   ├── workloads.sh
    │   │   └── workloads.yaml
    │   └── services/
    │       ├── serve_model.py
    │       └── serve_model.yaml
    ├── madewithml/
    │   ├── config.py
    │   ├── data.py
    │   ├── evaluate.py
    │   ├── models.py
    │   ├── predict.py
    │   ├── serve.py
    │   ├── train.py
    │   ├── tune.py
    │   └── utils.py
    ├── notebooks/
    │   ├── benchmarks.ipynb
    │   └── madewithml.ipynb
    ├── pyproject.toml
    ├── requirements.txt

```

---


##  Modules

<details closed><summary>.</summary>

| File                                                                                        | Summary                                                                                                                                                                                                                                         |
| ---                                                                                         | ---                                                                                                                                                                                                                                             |
| [requirements.txt](https://github.com/GokuMohandas/mlops-course/blob/main/requirements.txt) | The `requirements.txt` file contains the dependencies and libraries required by the parent repository for its various functionalities.                                                                                                          |
| [Makefile](https://github.com/GokuMohandas/mlops-course/blob/main/Makefile)                 | The Makefile in the repository provides functionality for styling and cleaning the code. It includes tasks for running linting and formatting tools, and for removing unnecessary files and directories.                                        |
| [pyproject.toml](https://github.com/GokuMohandas/mlops-course/blob/main/pyproject.toml)     | The code snippet in the `pyproject.toml` file configures various formatting and linting tools (Black, iSort, Flake8, PyUpgrade, Pytest) for the repository. It specifies the line length, excludes certain directories, and sets up test paths. |

</details>

<details closed><summary>deploy</summary>

| File                                                                                                       | Summary                                                                                                                                                                                                                                                                                    |
| ---                                                                                                        | ---                                                                                                                                                                                                                                                                                        |
| [cluster_env.yaml](https://github.com/GokuMohandas/mlops-course/blob/main/deploy/cluster_env.yaml)         | The code snippet, located at `deploy/cluster_env.yaml`, is used to specify the environment configuration for a cluster. It sets the base image, installs necessary Debian packages, defines Python packages and dependencies, and runs post-build commands to install additional packages. |
| [cluster_compute.yaml](https://github.com/GokuMohandas/mlops-course/blob/main/deploy/cluster_compute.yaml) | The code snippet at `deploy/cluster_compute.yaml` specifies the compute resources required for the deployment of a machine learning model. It defines the head node type, worker node types, and configures AWS settings such as block device mappings and tag specifications.             |

</details>

<details closed><summary>deploy/jobs</summary>

| File                                                                                                | Summary                                                                                                                                                                                                                                                                                        |
| ---                                                                                                 | ---                                                                                                                                                                                                                                                                                            |
| [workloads.yaml](https://github.com/GokuMohandas/mlops-course/blob/main/deploy/jobs/workloads.yaml) | The code snippet located at `deploy/jobs/workloads.yaml` defines the configurations for a project's workloads and environment settings. It specifies the project ID, cluster environment, compute configuration, runtime environment variables, entrypoint, and max retries for the workloads. |
| [workloads.sh](https://github.com/GokuMohandas/mlops-course/blob/main/deploy/jobs/workloads.sh)     | The code snippet is a shell script located at deploy/jobs/workloads.sh. It performs various tasks such as testing data and code, training a model, evaluating the model, testing the model, and saving results to S3.                                                                          |

</details>

<details closed><summary>deploy/services</summary>

| File                                                                                                        | Summary                                                                                                                                                                                                                                                                        |
| ---                                                                                                         | ---                                                                                                                                                                                                                                                                            |
| [serve_model.yaml](https://github.com/GokuMohandas/mlops-course/blob/main/deploy/services/serve_model.yaml) | The code snippet located at deploy/services/serve_model.yaml in the repository architecture defines the configuration for serving a model. It specifies details such as the project ID, cluster environment, compute configuration, runtime environment, and rollout strategy. |
| [serve_model.py](https://github.com/GokuMohandas/mlops-course/blob/main/deploy/services/serve_model.py)     | The code snippet in `deploy/services/serve_model.py` imports the necessary modules and dependencies, copies files from S3, and sets the entry point for model deployment.                                                                                                      |

</details>

<details closed><summary>madewithml</summary>

| File                                                                                         | Summary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ---                                                                                          | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [config.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/config.py)     | The config.py file in the madewithml directory sets up logging and configurations for the project, including directories, MLflow tracking URI, and logger configuration. It also defines a list of stopwords.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [models.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/models.py)     | The code snippet defines a model architecture called FinetunedLLM for a Large Language Model (LLM) that will be fine-tuned. It uses a pre-trained LLM, applies dropout, and has a fully connected layer for classification. The forward method takes a batch of input and returns the output logits.                                                                                                                                                                                                                                                                                                                                                                                                            |
| [predict.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/predict.py)   | The `predict.py` file is responsible for predicting tags (with probabilities) for input data. It includes functions to decode indices to labels, format probabilities, and predict tags for input data from a dataframe. It also includes a CLI command to get the best run ID from an MLflow experiment and a CLI command to predict tags for a project given its title and description.                                                                                                                                                                                                                                                                                                                       |
| [serve.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/serve.py)       | The serve.py file in the madewithml directory is responsible for handling the deployment of a machine learning model. It uses the FastAPI framework to create an API that performs tasks such as health checks, getting the run ID, evaluating data, and making predictions. It also applies custom logic to the predictions based on a threshold value. The file uses Ray to distribute the workload across replicas and sets up the necessary dependencies using the mlflow library.                                                                                                                                                                                                                          |
| [utils.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/utils.py)       | The `utils.py` file provides various utility functions for the `madewithml` module. These functions include:-`set_seeds(seed: int)`: Sets random seeds for reproducibility.-`load_dict(path: str)-> Dict`: Loads a dictionary from a JSON file.-`save_dict(d: Dict, path: str, cls: Any = None, sortkeys: bool = False)-> None`: Saves a dictionary to a specific location as a JSON file.-`pad_array(arr: np.ndarray, dtype=np.int32)-> np.ndarray`: Pads a 2D array with zeros until all rows in the array are of the same length as the longest row.-`collate_fn(batch: Dict[str, np.ndarray])-> Dict[str, torch.Tensor]`: Converts a batch of numpy arrays to tensors with                                  |
| [tune.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/tune.py)         | The `tune_models` function in the `madewithml/tune.py` file is responsible for running a hyperparameter tuning experiment using Ray Tune. It takes various input parameters like the experiment name, dataset location, initial parameters, and tuning configurations. It loads the dataset, sets up the training loop and scaling configurations, pre-processes the data, and initializes a TorchTrainer for training. It utilizes Ray Tune's HyperOptSearch algorithm to search for the best hyperparameters within a parameter space and uses an AsyncHyperBandScheduler for scheduling and early stopping. The results of the tuning experiment are returned as a `ray.tune.result_grid.ResultGrid` object. |
| [train.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/train.py)       | The code snippet defines the training loop for a machine learning model using PyTorch and Transformers. It includes functions for training and evaluation steps, as well as a main function for training the model on multiple workers in a distributed manner. The code also includes functions for data preprocessing and configuration settings for the training process.                                                                                                                                                                                                                                                                                                                                    |
| [evaluate.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/evaluate.py) | The code in evaluate.py file is responsible for evaluating a model's performance on a dataset. It calculates overall metrics, per-class metrics, and metrics for different slices. The results are then logged and optionally saved to a file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [data.py](https://github.com/GokuMohandas/mlops-course/blob/main/madewithml/data.py)         | The code snippet in the `madewithml/data.py` file provides functions and a class for loading, preprocessing, cleaning, and tokenizing data for a machine learning project. It also includes a custom preprocessor class.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

</details>

<details closed><summary>.github/workflows</summary>

| File                                                                                                              | Summary                                                                                                                                                                                                                                                                               |
| ---                                                                                                               | ---                                                                                                                                                                                                                                                                                   |
| [serve.yaml](https://github.com/GokuMohandas/mlops-course/blob/main/.github/workflows/serve.yaml)                 | The code snippet located at `.github/workflows/serve.yaml` sets up an automated workflow called serve that runs on specific events. It configures AWS credentials, sets up dependencies, and serves a machine learning model using AnyScale.                                          |
| [json_to_md.py](https://github.com/GokuMohandas/mlops-course/blob/main/.github/workflows/json_to_md.py)           | This code snippet converts a JSON file into a Markdown file. The converted Markdown file includes the key-value pairs from the JSON data, properly formatted in Markdown syntax.                                                                                                      |
| [workloads.yaml](https://github.com/GokuMohandas/mlops-course/blob/main/.github/workflows/workloads.yaml)         | The code snippet is a GitHub Actions workflow that runs a series of steps to execute and monitor workloads. It configures AWS credentials, sets up dependencies, runs workloads, reads results from S3, and comments the results on a Pull Request.                                   |
| [documentation.yaml](https://github.com/GokuMohandas/mlops-course/blob/main/.github/workflows/documentation.yaml) | The code snippet defines a GitHub Actions workflow that builds and deploys documentation for a repository using MkDocs. It runs on the main branch when code is pushed. It sets up dependencies, installs necessary packages, and deploys the documentation using `mkdocs gh-deploy`. |

</details>

<details closed><summary>notebooks</summary>

| File                                                                                                  | Summary                                                                                                                                           |
| ---                                                                                                   | ---                                                                                                                                               |
| [benchmarks.ipynb](https://github.com/GokuMohandas/mlops-course/blob/main/notebooks/benchmarks.ipynb) | This code snippet generates README files for repositories.                                                                                        |
| [madewithml.ipynb](https://github.com/GokuMohandas/mlops-course/blob/main/notebooks/madewithml.ipynb) | Code snippet: json_to_md.pyThis code snippet converts JSON data into Markdown format. It is part of the documentation workflow in the repository. |

</details>

---

##  Getting Started

***Prerequisites***

Ensure you have the following dependencies installed on your system:

- `► INSERT-DEPENDENCY-1`
- `► INSERT-DEPENDENCY-2`
- `► INSERT-DEPENDENCY-3`

###  Installation

1. Clone the mlops-course repository:
```sh
git clone https://github.com/GokuMohandas/mlops-course
```

2. Change to the project directory:
```sh
cd mlops-course
```

3. Install the dependencies:
```sh
pip install -r requirements.txt
```

###  Running mlops-course

```sh
python main.py
```

###  Tests
```sh
pytest
```

---


##  Project Roadmap

> - [X] `ℹ️  Task 1: Implement X`
> - [ ] `ℹ️  Task 2: Implement Y`
> - [ ] `ℹ️ ...`


---

##  Contributing

Contributions are welcome! Here are several ways you can contribute:

- **[Submit Pull Requests](https://github.com/GokuMohandas/mlops-course/blob/main/CONTRIBUTING.md)**: Review open PRs, and submit your own PRs.
- **[Join the Discussions](https://github.com/GokuMohandas/mlops-course/discussions)**: Share your insights, provide feedback, or ask questions.
- **[Report Issues](https://github.com/GokuMohandas/mlops-course/issues)**: Submit bugs found or log feature requests for GOKUMOHANDAS.

#### *Contributing Guidelines*

<details closed>
<summary>Click to expand</summary>

1. **Fork the Repository**: Start by forking the project repository to your GitHub account.
2. **Clone Locally**: Clone the forked repository to your local machine using a Git client.
   ```sh
   git clone <your-forked-repo-url>
   ```
3. **Create a New Branch**: Always work on a new branch, giving it a descriptive name.
   ```sh
   git checkout -b new-feature-x
   ```
4. **Make Your Changes**: Develop and test your changes locally.
5. **Commit Your Changes**: Commit with a clear and concise message describing your updates.
   ```sh
   git commit -m 'Implemented new feature x.'
   ```
6. **Push to GitHub**: Push the changes to your forked repository.
   ```sh
   git push origin new-feature-x
   ```
7. **Submit a Pull Request**: Create a PR against the original project repository. Clearly describe the changes and their motivations.

Once your PR is reviewed and approved, it will be merged into the main branch.

</details>

---

##  License


This project is protected under the [SELECT-A-LICENSE](https://choosealicense.com/licenses) License. For more details, refer to the [LICENSE](https://choosealicense.com/licenses/) file.

---

##  Acknowledgments

- List any resources, contributors, inspiration, etc. here.

[**Return**](#Top)

---
